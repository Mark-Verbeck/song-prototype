name: Deploy Vue App to GitHub Pages # Changed name for clarity

on:
  workflow_dispatch:
  push:
    branches:
      - main

jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      # - run: corepack enable # <-- REMOVE THIS unless you specifically use Yarn 2+ for this project
      - uses: actions/setup-node@v4
        with:
          node-version: "20" # Ensure this matches your project's Node.js version if specific

      - name: Install dependencies # <-- Standard for most JS projects
        run: npm install

      - name: Build Vue application # <-- CRITICAL CHANGE: Use npm run build for Vue
        # You might need to set a publicPath/base for Vue Router/assets
        # depending on your Vue setup and how you want URLs to resolve.
        # This is typically done in vue.config.js or vite.config.js
        # Example for Vue CLI:
        # run: npm run build -- --dest docs # if you want to output to /docs
        run: npm run build # Assuming your package.json has a "build" script

      - name: Upload artifact
        uses: actions/upload-pages-artifact@v3
        with:
          # <-- CRITICAL CHANGE: Point to the standard Vue build output directory
          path: ./dist # For Vue CLI/Vite, this is typically 'dist'

  # Deployment job
  deploy:
    needs: build
    permissions:
      pages: write
      id-token: write
    environment:
      name: github-pages # Ensure this matches the name in your repo settings > Pages
      url: ${{ steps.deployment.outputs.page_url }}
    runs-on: ubuntu-latest
    steps:
      - name: Deploy to GitHub Pages
        id: deployment
        uses: actions/deploy-pages@v4
